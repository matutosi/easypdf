# 簡単PDF(easyPDF)の使い方  
# How to use easyPDF  

## 簡単PDFとは   
## What is easyPDF?   

簡単PDFは，PDFの結合などを簡単に行うためのソフトです．
2025年2月現在では結合(combine_pdf)と強調表示(highlight_pdf)のみです．

easyPDF is a software for easy manipulations such as combining PDFs.
Only combine (combine_pdf) and highlight (highlight_pdf) is available at 2025 Feb.


**注意**
実行ファイルの動作確認は，Win11のみで行っています．
他のOSでは，Pythonを使うか自分でビルドしてください．

**WARNING**
easyPDF work partly on Win 11. 
Use Python or build by your self in other OS.

## 免責事項   
## Disclaimer   

簡単PDFの使用による不利益への責任は負えませんので，自己責任でご利用ください．
不具合がありましたら，松村(matutosi@gmail.com)にご連絡ください．

I am not responsible for any disadvantages caused by the use of this software easyPDF, 
so please use it at your own risk.
If you have any problems, please contact Matsumura (matutosi@gmail.com).

## 導入方法   
## Installation   

*_pdf.exe と *_pdf.xlsx を任意のディレクトリに保存するだけです．   

copy *_pdf.exe and *_pdf.xlsx to one directory.

## 使い方   
## How to use   

### Combine PDF

- ファイルの結合
    - conbime_pdf.py   ソースコード(pypdf版)
    - conbime_pdf2.py  ソースコード(PyMuPDF版)
    - conbime_pdf.exe  実行ファイル(Windows)
    - conbime_pdf.xlsx 設定ファイル

1. 結合するPDFファイルを combine_pdf.exe と同じディレクトリに保存．   
2. combine_pdf.xlsx のinputs列とoutputs列にファイル名を入力．
    - inputs: 入力ファイル名
    - outputs: 出力ファイル名
    - outputs列のファイル名が同じものを上から順に結合．
3. combine_pdf.exe をクリックして実行．

combine_pdf.xlsx が次のように入力されており，[01.pdf, 02.pdf, 03.pdf, 04.pdf]の4つのPDFファイルがあるとき，
01.pdf と 02.pdf を結合した aa.pdf および 03.pdf と 04.pdf を結合したbb.pdf が生成されます．

| inputs | outputs |
| ------ | ------- |
| 01.pdf | aa.pdf  |
| 02.pdf | aa.pdf  |
| 03.pdf | bb.pdf  |
| 04.pdf | bb.pdf  |


- combine pdf files
    - conbime_pdf.py   code (pypdf version)
    - conbime_pdf2.py  code (PyMuPDF version)
    - conbime_pdf.exe  execute file in windows
    - conbime_pdf.xlsx setting file

This is how to use conbime_pdf.py. 
How to use other tools are almost similar.

1. Save the PDF files to be combined in the same directory with combine_pdf.exe.   
2. Enter the file names in the inputs and outputs columns of combine_pdf.xlsx.   
    - inputs: input file names   
    - outputs: output file name   
    - The files with the same 
    Input files will be combined according the name in the outputs column from the top. 
3. Click on combine_pdf.exe to run.  

If combine_pdf.xlsx is entered as follows and there are four PDF files [01.pdf, 02.pdf, 03.pdf, 04.pdf], 
then aa.pdf is generated by combining 01.pdf and 02.pdf, and bb.pdf by combining 03.pdf and 04.pdf.

| inputs | outputs |
| ------ | ------- |
| 01.pdf | aa.pdf  |
| 02.pdf | aa.pdf  |
| 03.pdf | bb.pdf  |
| 04.pdf | bb.pdf  |

### Hightligt PDF

- 強調表示
    - hightligt_pdf.py
    - hightligt_pdf.exe  実行ファイル
    - hightligt_pdf.xlsx 設定ファイル

1. 強調表示するPDFファイルを hightligt_pdf.exe と同じディレクトリに保存．   
2. hightligt_pdf.xlsx のkeywords列とcolors列に入力．
    - keywords: 強調表示する文字列
    - colors:   強調表示で使う色(以下が利用可能)
        - purple: 紫
        - yellow: 黄
        - red   : 赤
        - sky   : 空
        - blue  : 青
        - green : 緑
        - gray  : 灰
3. hightligt_pdf.exe をクリックして実行．


- Hightligt
    - hightligt_pdf.py   code
    - hightligt_pdf.exe  execute file
    - hightligt_pdf.xlsx setting file

1. Save pdf file(s) to be hightligted in the same directory with hightligt_pdf.exe.
2. Enter the keywords and colors columns of hightligt_pdf.xlsx.   
    - keywords: strings to be hightligted
    - colors:   color name (can use the color name as below)
        - purple   
        - yellow   
        - red      
        - sky      
        - blue     
        - green    
        - gray     

3. Click on hightligt_pdf.exe to run.  

## Use on python (>= 3.9.0)

### Clone easypdf

```
git clone https://github.com/matutosi/easypdf.git
```

Library openpyxl is necessary to read xlsx file (indirectly used in combine_pdf.py through pandas).

```
python.exe -m pip install --upgrade pip
pip install pandas
pip install openpyxl
pip install pypdf
pip install PyMuPDF
pip install pyinstaller
```

### Run

```
python combine_pdf.py
python hightligt_pdf.py
```

## How to build with pyinstaller

This is how to build combine_pdf.exe. 

### Clone easypdf

```
git clone https://github.com/matutosi/easypdf.git
```

### Vertial environment

Opstional but RECOMMENDED to reduce execute file.

```
python -m venv combine_pdf
.\combine_pdf\Scripts\Activate
cd combine_pdf
```


### Libraries

Library openpyxl is necessary to read xlsx file (indirectly used in combine_pdf.py through pandas).

```
python.exe -m pip install --upgrade pip
pip install pandas
pip install openpyxl
pip install pypdf
pip install pyinstaller
```

### pyinstaller

Create setting file (*.spec).

```
pyi-makespec combine_pdf.py -n combine_pdf --onefile
```

Create execute file.

```
pyinstaller combine_pdf.spec
```

Wait for moments to finish.
